{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\IT\\\\Documents\\\\GitHub\\\\coll2030\\\\src\\\\ProductImageList.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport Grid from '@mui/material/Grid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ProductImageList() {\n  _s();\n\n  const [state, setData] = useState({\n    products: []\n  });\n  useEffect(() => {\n    fetchData();\n  }, []);\n  useEffect(() => {\n    document.addEventListener('scroll', () => {\n      debugger;\n    });\n    return () => document.removeEventListener;\n  }, []);\n\n  async function handleDocScroll(e) {\n    debugger;\n    const scrollHeight = scroller.scrollHeight;\n    const scrollTop = scroller.scrollTop;\n    const clientHeight = scroller.clientHeight;\n\n    if (scrollHeight === scrollTop + clientHeight && !this.bottomReached) {\n      this.bottomReached = true;\n      let prevPage = parseInt(localStorage.getItem('page'));\n      let nextPage = ++prevPage;\n      localStorage.setItem('page', nextPage);\n      document.getElementById('collection-container').insertAdjacentHTML('beforeend', `<div id=\"spinner\" class=\"d-flex justify-content-center align-items-center\"><div  class=\"spinner-border text-info\" style=\"width: 5rem; height: 5rem;\" role=\"status\">\n        <span class=\"visually-hidden\">Loading...</span>\n      </div></div>`);\n      await this.fetchData(nextPage * 70);\n      window.history.replaceState(null, null, `?page=${nextPage}`);\n      var spinnerElem = document.getElementById('spinner');\n      spinnerElem.parentNode.removeChild(spinnerElem);\n      this.bottomReached = false; // console.log('scrollHeight...', document.getElementById('collection-container').scrollHeight)\n      // console.log('scrollTop...', document.getElementById('collection-container').scrollTop)\n      // console.log('clientHeight...', document.getElementById('collection-container').clientHeight)\n      //console.log('botton reached')\n    }\n  }\n\n  async function fetchData() {\n    const gender = localStorage.getItem('gender');\n    const subcategory = localStorage.getItem('subcategory');\n    const category = localStorage.getItem('category');\n    const url = `/.netlify/functions/atlas?gender=${gender}&category=${category}&subcategory=pantolon&page=${100}`;\n    const response = await fetch(url, {\n      cache: 'default'\n    });\n    const {\n      data\n    } = await response.json();\n    setData({\n      products: data\n    });\n    console.log(data);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    justifyContent: \"center\",\n    spacing: 1,\n    children: state.products.map((item, i) => {\n      return /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        children: /*#__PURE__*/_jsxDEV(ImageComponent, {\n          plcHolder: item.plcHolder,\n          imageUrl: item.imageUrl,\n          title: item.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 16\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProductImageList, \"6Tw1vIR4k27h+8CCVbfnm3HCXyc=\");\n\n_c = ProductImageList;\n\nfunction ImageComponent(props) {\n  _s2();\n\n  const imageEl = useRef(null);\n  useEffect(() => {\n    if (window.IntersectionObserver) {\n      let observer = new IntersectionObserver((entries, observer) => {\n        entries.forEach(entry => {\n          if (entry.isIntersecting) {\n            //  console.log(entry);\n            entry.target.src = entry.target.dataset.src;\n            observer.unobserve(entry.target);\n          }\n        });\n      }, {\n        threshold: 0.1\n      });\n      window.obz = observer;\n      window.obz.observe(imageEl.current);\n    }\n  }, [props]);\n  return /*#__PURE__*/_jsxDEV(\"img\", {\n    ref: imageEl,\n    src: props.plcHolder,\n    \"data-src\": 'https://res.cloudinary.com/codergihub/image/fetch/w_250/' + props.imageUrl,\n    alt: props.title,\n    loading: \"lazy\",\n    width: \"250\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(ImageComponent, \"5ZOT5nfFeGHZZIfSn52hZV7XqdA=\");\n\n_c2 = ImageComponent;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ProductImageList\");\n$RefreshReg$(_c2, \"ImageComponent\");","map":{"version":3,"names":["React","useEffect","useState","useRef","Grid","ProductImageList","state","setData","products","fetchData","document","addEventListener","removeEventListener","handleDocScroll","e","scrollHeight","scroller","scrollTop","clientHeight","bottomReached","prevPage","parseInt","localStorage","getItem","nextPage","setItem","getElementById","insertAdjacentHTML","window","history","replaceState","spinnerElem","parentNode","removeChild","gender","subcategory","category","url","response","fetch","cache","data","json","console","log","map","item","i","plcHolder","imageUrl","title","ImageComponent","props","imageEl","IntersectionObserver","observer","entries","forEach","entry","isIntersecting","target","src","dataset","unobserve","threshold","obz","observe","current"],"sources":["C:/Users/IT/Documents/GitHub/coll2030/src/ProductImageList.js"],"sourcesContent":["\r\n\r\n\r\n\r\nimport React, { useEffect, useState,useRef } from 'react';\r\n\r\nimport Grid from '@mui/material/Grid'\r\nexport default function ProductImageList() {\r\n  const [state, setData] = useState({ products: [] });\r\n\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    fetchData()\r\n\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n\r\n    document.addEventListener('scroll', ()=>{\r\n      debugger;\r\n    });\r\n\r\n    return ()=> document.removeEventListener\r\n\r\n  }, []);\r\n\r\n  async function handleDocScroll(e){\r\ndebugger;\r\n    const scrollHeight = scroller.scrollHeight\r\n    const scrollTop = scroller.scrollTop\r\n    const clientHeight = scroller.clientHeight\r\n    if (scrollHeight === (scrollTop + clientHeight) && !this.bottomReached) {\r\n        this.bottomReached = true\r\n        let prevPage = parseInt(localStorage.getItem('page'))\r\n        let nextPage = ++prevPage\r\n        localStorage.setItem('page', nextPage)\r\n        document.getElementById('collection-container').insertAdjacentHTML('beforeend', `<div id=\"spinner\" class=\"d-flex justify-content-center align-items-center\"><div  class=\"spinner-border text-info\" style=\"width: 5rem; height: 5rem;\" role=\"status\">\r\n        <span class=\"visually-hidden\">Loading...</span>\r\n      </div></div>`)\r\n        await this.fetchData(nextPage * 70)\r\n         window.history.replaceState(null, null, `?page=${nextPage}`);\r\n        var spinnerElem = document.getElementById('spinner');\r\n        spinnerElem.parentNode.removeChild(spinnerElem);\r\n        this.bottomReached = false\r\n        // console.log('scrollHeight...', document.getElementById('collection-container').scrollHeight)\r\n        // console.log('scrollTop...', document.getElementById('collection-container').scrollTop)\r\n        // console.log('clientHeight...', document.getElementById('collection-container').clientHeight)\r\n        //console.log('botton reached')\r\n    }\r\n\r\n  }\r\n\r\n  async function fetchData() {\r\n    const gender = localStorage.getItem('gender')\r\n    const subcategory = localStorage.getItem('subcategory')\r\n    const category = localStorage.getItem('category')\r\n    const url = `/.netlify/functions/atlas?gender=${gender}&category=${category}&subcategory=pantolon&page=${100}`\r\n\r\n    const response = await fetch(url, { cache: 'default' })\r\n\r\n    const { data } = await response.json()\r\n\r\n    setData({ products: data })\r\n    console.log(data)\r\n\r\n  }\r\n\r\n\r\n  return (\r\n\r\n    <Grid container justifyContent=\"center\" spacing={1}  \r\n    >\r\n      {state.products.map((item, i) => {\r\n     \r\n        return <Grid item key={i} >\r\n          <ImageComponent plcHolder={item.plcHolder} imageUrl={item.imageUrl} title={item.title} />\r\n        </Grid>\r\n      })}\r\n    </Grid>\r\n\r\n\r\n  );\r\n}\r\n\r\n\r\nfunction ImageComponent(props) {\r\n  const imageEl = useRef(null);\r\n  useEffect(() => {\r\n   \r\n      if (window.IntersectionObserver) {\r\n\r\n        let observer = new IntersectionObserver((entries, observer) => {\r\n          entries.forEach(entry => {\r\n            if (entry.isIntersecting) {\r\n              //  console.log(entry);\r\n              entry.target.src = entry.target.dataset.src;\r\n              observer.unobserve(entry.target);\r\n            }\r\n          });\r\n        }, { threshold: 0.1 });\r\n        window.obz = observer\r\n        window.obz.observe(imageEl.current)\r\n\r\n      }\r\n    \r\n\r\n  }, [props]);\r\n  return (\r\n    <img ref={imageEl}\r\n      src={props.plcHolder}\r\n      data-src={'https://res.cloudinary.com/codergihub/image/fetch/w_250/' + props.imageUrl}\r\n      alt={props.title}\r\n      loading=\"lazy\"\r\n      width=\"250\"\r\n    />\r\n  )\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}